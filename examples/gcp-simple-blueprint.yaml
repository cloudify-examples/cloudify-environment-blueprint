tosca_definitions_version: cloudify_dsl_1_3


imports:
  - http://www.getcloudify.org/spec/cloudify/4.0.1/types.yaml
  - http://getcloudify.org.s3.amazonaws.com/spec/gcp-plugin/1.0/plugin.yaml

dsl_definitions:
  - &gcp_config
    auth: { get_secret: gcp_auth }
    project: { get_secret: project }
    network: { get_secret: network }
    zone: { get_secret: zone }


node_templates:
  vm:
    type: cloudify.gcp.nodes.Instance
    properties:
      image_id: { get_secret: ubuntu_trusty_image }
      gcp_config: *gcp_config
      install_agent: false


outputs:
  ip:
    value: { get_attribute: [vm, ip] }
  name:
    value: { get_attribute: [vm, name] }
